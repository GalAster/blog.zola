+++
title = "寻找数列万能公式"
date = 2018-03-24
[taxonomies]
tags = [""]
categories = [""]
+++

<p>自学生时代以走来,  总是对公式有种迷信, 无数伟大人物, 将一生成就凝练为公式造福后人, 解题只需记住并活用公式即可.</p><p>久而久之, 就对一些老师没有讲过的东西怀有好奇, 比如素数有没有公式? 自然数倒数和有没有公式? 有没有万能的数列公式?</p><p>当然数学中抛开定义谈问题都是耍流氓, 函数你承不承认是公式? 那我随手画条线把所有的点连起来这叫图像函数吧, 这算不算公式?</p><p>所以数学上什么才叫公式呢?</p><h3>初等函数</h3><p>素数自然是有公式的, 有好几个, 一般长这样:</p><p class="math">$$p_n=1+\sum_{m=1}^{2^n}\left\lfloor \sqrt[n]{\left\lfloor n\biggl/\sum_{k=1}^m {\left\lfloor \cos^{2} \lfloor \pi\dfrac{(k-1)!+1}{k} \rfloor \right\rfloor} \right\rfloor} \right\rfloor$$</p> <p>自然数倒数和也是有公式的, <span class="math">$\sum_{n>1}=H_n$</span> </p><p>当然你觉得这不叫公式也无所谓, 因为这的确不是一般意义上的公式.</p><p>所谓的公式能分为以下五个等级:</p><ol><li><p>只用加减乘除的公式叫做 <b>算数表达式(Arithmetic expressions)</b>.</p></li><li><p>加入幂, 开根之后叫做 <b>代数表达式(Algebraic expressions)</b>.</p></li><li><p>允许使用初等函数的公式叫做 <b>封闭形式(Closed-form expressions)</b>, 也可以叫初等表达式.</p></li><li><p>允许使用级数算符的公式叫 <b>解析形式(Analytic expressions)</b>, 其中级数要求收敛, 不能是形式幂级数.</p></li><li><p>剩下的统称为<b>数学定义式(Mathematical expressions)</b>, 允许使用包括极限、微分与积分算符在内的一切数学符号, 级数可以是单点收敛的形式幂级数, 甚至式子不必用等式定义, 直接说是某个方程的解.</p></li></ol><p>平常所谓的公式一般是第三个等级, 允许使用一切初等函数. 当然没学过函数那就是第二级, 理工科大学生自行把公式的定义提到第四级, 我肯定已经到了第五级了喽,lol...</p><p>基本初等函数是由刘伟尔钦定的函数集合, 只有<b>反对幂三指常</b>六种, 在这之外的函数都被称为特殊函数, 没有高等函数这种东西的...</p><p>基本初等函数的复合叫做初等函数.</p><p>显然一般的分段函数, 取整函数这些都不是初等函数. 绝对值函数倒也是初等函数, 这是特殊的分段函数嘛...</p><h3>分段函数</h3><p>用分段函数我们有个无耻的办法给出万能公式, 大不了每个点上给的定义呗</p><p>什么, 你说太无耻了? 那好, 大不了两个点之间连起来啊,233...</p><p>不说笑了, 我们知道两点确定一条直线, 或者可以等价的说成两个点确定一条一次函数曲线.</p><p>那我们固定两端的点, 然后把曲线扭动变成二次函数, 让它贴合第三个点, 可以吗?</p><p>这叫样条插值, 用三次曲线就叫三次曲线样条插值, 也可与不用多项式, 用别的, 比如B样条插值就是用贝塞尔曲线(BezierCurve).</p><p>![](https://i.loli.net/2018/03/24/5ab63a46384a5.gif)</p><p>那不断提升次数会怎么样呢?</p><h3>插值函数</h3><p><span class="math">$n$</span>  个点最多能确定了一个 <span class="math">$n-1$</span>  次的多项式.</p><p>那么用待定系数法, 解一个 <span class="math">$n-1$</span>  元方程即可, 于是可以用矩阵求解.</p><p class="math">$$\begin{cases}
y_1 = a_0 + a_1x_1 + a_2x_1^2+\cdots+a_nx_1^n\\
y_2 = a_0 + a_1x_2 + a_2x_2^2+\cdots+a_nx_2^n\\
y_3 = a_0 + a_1x_3 + a_2x_3^2+\cdots+a_nx_3^n \\
\cdots\cdots\cdots\cdots\cdots\cdots\cdots\cdots\cdots\cdots\cdots \\
y_n = a_0 + a_1x_n + a_2x_n^2+\cdots+a_nx_n^n
\end{cases}$$</p> <p class="math">$$
\begin{pmatrix}
y_1 \\ y_2 \\ y_3 \\ \vdots\\y_n
\end{pmatrix}
=
\begin{pmatrix}
1 & x_1 & x_1^2 &\cdots&x_1^n\\
1 & x_2 & x_2^2 &\cdots&x_2^n\\
1 & x_3 & x_3^2 &\cdots&x_3^n\\
\vdots&\vdots&\vdots&\ddots&\vdots&\\
1 & x_n & x_n^2 &\cdots&x_n^n\\
\end{pmatrix}
\begin{pmatrix}
a_0 \\ a_1 \\ a_2 \\ \vdots\\a_n
\end{pmatrix}
$$</p> <p>或者简写成:</p><p class="math">$$\vec{y}=X\vec{a}$$</p> <p>两边左乘逆矩阵 <span class="math">$X^{-1}$</span>  即可,  同时 <span class="math">$|X|\ne0$</span> , 说明方程只有唯一解. 也就是说这样的多项式是唯一的.</p><p>解出来后原来的式子可以重写为:</p><p class="math">$$P(x):=\sum_{j=0}^{k}y_{j}\prod _{0\leq m\leq k}^{m\neq j}{\frac {x-x_{m}}{x_{j}-x_{m}}}$$</p> <p>手解这个也太丧病了点, 编程大法好...</p><p>![](https://i.loli.net/2018/03/24/5ab63a461dd88.png)</p><h3>生成函数</h3><p>生成函数就是另一种概念上的东西了, 我们知道一个函数在原点的<b>多项式级数展开</b>被称为麦克劳林展开,且这样的展开是唯一的.</p><p>也就是说, 一个函数唯一确定了一个系数数列. <b>反过来, 一个数列也唯一确定了一个函数呀!</b></p><p>比如 <span class="math">$G(x)=e^x=\sum _{n=0}^{\infty }{\dfrac {x^{n}}{n!}}\quad \forall x\in\mathbb{R}$</span>  .</p><p>那么可以记 <span class="math">$g_n=[z^n]G(x)=\dfrac{1}{n!}$</span> , 此时 <span class="math">$G(x)$</span>  就被称为 <span class="math">$g_n$</span>  的生成函数.</p><p>对一个有限的数列而言, 它的生成函数就是个 <span class="math">$n$</span>  次多项式.</p><p>生成函数并非数列换个写法这么简单, 一方面生成函数相当于定义了一种新的运算, 大大扩展了能表示的数列的种类.</p><p>比如高次求和中出现的伯努利数, 本身只有递推计算式, 没有初等表达式, 但它的生成函数是初等的.</p><p class="math">$$\frac{B_n}{n!}=[z^n]\left(\frac{z}{e^z-1}\right)$$</p> <p>更重要的是, 生成函数事实上蕴含了数列本身的一切信息.</p><p>比如数列和就是 <span class="math">$G(1)$</span> , 其他什么数列极限数列的渐进性质都在里面了, 数列通项什么的已经无所谓了.</p><p>可以想象, 即便如此, 还是会有很多的式子无能为力, 生成函数的另一个强大的地方就是化离散为连续, 使用微积分, 复分析乃至更强大的方法来研究.</p><h3>后记</h3><p>初学者总是觉得通项公式是万能的东西, 有了这个一切都能迎刃而解.</p><p>不过你看素数有公式吧, 各种有关素数的猜想都没秒杀了吗?</p><p>就算是高考题中, 不用解出通项也能搞定的题多了去了, 有的出题老师压根就没准备让你解出通项...</p><p>经典的比如 <span class="math">$a_1=1;a_{n+1}=\dfrac{1}{a_n}+a_n$</span> , 这么多年了, 总是能隔三差五看到有人试图求其通项.可原题明明要你证不等式啊!</p><p>就算是从业者中竟然也有人对 N-S 方程暂没有解析解感到恐惧, 迷信公式看轻数值, 搞得好像有了解析解就不用显卡算了一样, 人类能直接殖民月球了.</p><p>也许是因为公式是一种物理实在吧, 能给人以安全感.</p><p>数学到了一定层次, 都是在与抽象的不可名状物战斗了. 你是航天员, 要探索人类的未知领域, 在太空还能用地面那一套吗?</p><p>万能公式存在也不存在, 一切所谓的公式不过是概念的封装. 人最重要的是人的品格而非名字, 函数也是如此, 叫什么重要吗? 有没有公式重要吗?</p><pre style="background-color:#2b303b;">
<span style="color:#eb6772;">data</span><span style="color:#adb7c9;">=</span><span style="color:#eb6772;">BlockRandom</span><span style="color:#abb2bf;">[</span><span style="color:#eb6772;">SeedRandom</span><span style="color:#abb2bf;">[</span><span style="color:#db9d63;">42</span><span style="color:#abb2bf;">]</span><span style="color:#adb7c9;">;</span><span style="color:#eb6772;">Table</span><span style="color:#abb2bf;">[</span><span style="color:#eb6772;">Exp</span><span style="color:#abb2bf;">[</span><span style="color:#adb7c9;">-</span><span style="color:#db9d63;">3 </span><span style="color:#eb6772;">x</span><span style="color:#adb7c9;">/</span><span style="color:#abb2bf;">(</span><span style="color:#db9d63;">2</span><span style="color:#adb7c9;">+ </span><span style="color:#eb6772;">x</span><span style="color:#adb7c9;">+</span><span style="color:#eb6772;">x</span><span style="color:#abb2bf;">^</span><span style="color:#db9d63;">2</span><span style="color:#abb2bf;">)]</span><span style="color:#adb7c9;">+</span><span style="color:#eb6772;">RandomReal</span><span style="color:#abb2bf;">[{</span><span style="color:#adb7c9;">-</span><span style="color:#db9d63;">.5</span><span style="color:#abb2bf;">,</span><span style="color:#db9d63;">.5</span><span style="color:#abb2bf;">}],
</span><span style="color:#abb2bf;">  {</span><span style="color:#eb6772;">x</span><span style="color:#abb2bf;">,</span><span style="color:#adb7c9;">-</span><span style="color:#db9d63;">10</span><span style="color:#abb2bf;">,</span><span style="color:#db9d63;">10</span><span style="color:#abb2bf;">}]
</span><span style="color:#abb2bf;">]</span><span style="color:#adb7c9;">;
</span><span style="color:#5cb3fa;">p</span><span style="color:#abb2bf;">[</span><span style="color:#eb6772;">i_</span><span style="color:#abb2bf;">]</span><span style="color:#adb7c9;">:=</span><span style="color:#eb6772;">ListLinePlot</span><span style="color:#abb2bf;">[</span><span style="color:#eb6772;">Labeled</span><span style="color:#abb2bf;">[</span><span style="color:#eb6772;">data</span><span style="color:#abb2bf;">,</span><span style="color:#eb6772;">Text</span><span style="color:#adb7c9;">@</span><span style="color:#eb6772;">Style</span><span style="color:#abb2bf;">[</span><span style="color:#eb6772;">ToString</span><span style="color:#adb7c9;">@</span><span style="color:#eb6772;">i</span><span style="color:#adb7c9;">&lt;&gt;</span><span style="color:#9acc76;">&quot;次插值&quot;</span><span style="color:#abb2bf;">,</span><span style="color:#db9d63;">15</span><span style="color:#abb2bf;">],{</span><span style="color:#eb6772;">Scaled</span><span style="color:#abb2bf;">[</span><span style="color:#db9d63;">0.35</span><span style="color:#abb2bf;">],</span><span style="color:#db9d63;">Above</span><span style="color:#abb2bf;">}],</span><span style="color:#eb6772;">AspectRatio</span><span style="color:#adb7c9;">-&gt;</span><span style="color:#db9d63;">1</span><span style="color:#adb7c9;">/</span><span style="color:#db9d63;">3</span><span style="color:#abb2bf;">,
</span><span style="color:#abb2bf;">  </span><span style="color:#eb6772;">InterpolationOrder</span><span style="color:#adb7c9;">-&gt;</span><span style="color:#eb6772;">i</span><span style="color:#abb2bf;">,</span><span style="color:#eb6772;">PlotRange</span><span style="color:#adb7c9;">-&gt;</span><span style="color:#abb2bf;">{</span><span style="color:#db9d63;">0</span><span style="color:#abb2bf;">,</span><span style="color:#db9d63;">6</span><span style="color:#abb2bf;">},
</span><span style="color:#abb2bf;">  </span><span style="color:#eb6772;">PlotStyle</span><span style="color:#adb7c9;">-&gt;</span><span style="color:#eb6772;">Directive</span><span style="color:#abb2bf;">[</span><span style="color:#db9d63;">Orange</span><span style="color:#abb2bf;">, </span><span style="color:#db9d63;">Dashed</span><span style="color:#abb2bf;">],</span><span style="color:#eb6772;">PlotTheme</span><span style="color:#adb7c9;">-&gt;</span><span style="color:#9acc76;">&quot;Business&quot;</span><span style="color:#abb2bf;">,
</span><span style="color:#abb2bf;">  </span><span style="color:#eb6772;">Mesh</span><span style="color:#adb7c9;">-&gt;</span><span style="color:#db9d63;">Full</span><span style="color:#abb2bf;">,</span><span style="color:#eb6772;">MeshStyle</span><span style="color:#adb7c9;">-&gt;</span><span style="color:#db9d63;">Blue</span><span style="color:#abb2bf;">,</span><span style="color:#eb6772;">ImageSize</span><span style="color:#adb7c9;">-&gt;</span><span style="color:#db9d63;">Large
</span><span style="color:#abb2bf;">]</span><span style="color:#adb7c9;">;
</span><span style="color:#eb6772;">Export</span><span style="color:#abb2bf;">[</span><span style="color:#9acc76;">&quot;万能公式_1.gif&quot;</span><span style="color:#abb2bf;">,</span><span style="color:#eb6772;">p</span><span style="color:#adb7c9;">/@</span><span style="color:#eb6772;">Range</span><span style="color:#abb2bf;">[</span><span style="color:#db9d63;">0</span><span style="color:#abb2bf;">,</span><span style="color:#db9d63;">10</span><span style="color:#abb2bf;">],
</span><span style="color:#abb2bf;">  </span><span style="color:#9acc76;">&quot;AnimationRepetitions&quot;</span><span style="color:#adb7c9;">-&gt;</span><span style="color:#db9d63;">Infinity</span><span style="color:#abb2bf;">,
</span><span style="color:#abb2bf;">  </span><span style="color:#9acc76;">&quot;DisplayDurations&quot;</span><span style="color:#adb7c9;">-&gt;</span><span style="color:#db9d63;">1
</span><span style="color:#abb2bf;">]</span></pre>
