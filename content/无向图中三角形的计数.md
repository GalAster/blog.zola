+++
title = "无向图中三角形的计数"
date = 2020-03-07
[taxonomies]
+++

<p><a href="href=\"https://www.zhihu.com/question/36652212\"">https://www.zhihu.com/question/36652212</a></p><p><a href="href=\"https://m.tau.ac.il/~nogaa/PDFS/ayz97.pdf\"">https://m.tau.ac.il/~nogaa/PDFS/ayz97.pdf</a></br><a href="href=\"https://www.zhihu.com/question/63596038\"">https://www.zhihu.com/question/63596038</a></p><p><a href="href=\"http://mathworld.wolfram.com/GraphCycle.html\"">http://mathworld.wolfram.com/GraphCycle.html</a></p><p><b>符号</b>：给定简单无向图 <span class="math">$G = (V, E)$</span>  ，分别用 <span class="math">$n$</span>  和 <span class="math">$m$</span>  表示顶点和边的个数，即 <span class="math">$n=|V|$</span>  和 <span class="math">$m=|E|$</span>  。</p><p>我们用 <span class="math">$A$</span>  表示 <span class="math">$G$</span>  的邻接矩阵，用 <span class="math">$\Delta$</span>  表示 <span class="math">$G$</span>  中三角形的个数，用 <span class="math">$\omega<2.376$</span>  表示矩阵乘法的指数，用 <span class="math">$(u - v - w)$</span>  表示一条长度为 <span class="math">$2$</span>  的简单路径（顶点依次为 <span class="math">$u, v, w$</span>  ）。</p><p><span class="math">$\Delta =trace(A^3)/6$</span>  。这个方法的复杂度为 <span class="math">$O(n^\omega) = O(n^{2.376})$</span>  。</p><p>令 <span class="math">$\gamma = m^{(\omega - 1)/(\omega + 1)}$</span>  。根据顶点的度数，将 <span class="math">$G$</span>  的顶点 <span class="math">$V$</span>  划分成两个集合：</p><ul><li><p><span class="math">$V_1 = \{v \in V \ \mid\ d_v \leq \gamma\}$</span> </p></li><li><p><span class="math">$V_2= \{v \in V \ \mid\ d_v > \gamma\}$</span> </p></li></ul><p>这里， <span class="math">$d_v$</span>  表示 <span class="math">$v$</span>  的度数。</p><p>我们首先枚举所有满足 <span class="math">$v \in V_1 的 (u - v - w)$</span>  。这一步可以在 <span class="math">$O(m \cdot \gamma)$</span>  内完成（对于每条边  <span class="math">$(u, v)$</span>  ，如果 <span class="math">$v \in V_1$</span>  ，则进一步遍历 <span class="math">$v$</span>  的邻接边）。</p><p>对于每条找到的 <span class="math">$(u - v - w)$</span>  ，如果 <span class="math">$(u, w) \in E$</span>  ，则 <span class="math">$u , v , w$</span>  构成三角形。这一步可算出所有包含了 <span class="math">$V_1$</span>  的点的三角形的个数。</p><p>对于任意一个在第一步中没有被统计到的三角形，它的3个顶点都属于 <span class="math">$V_2$</span>  。因此，我们首先构造 <span class="math">$V_2$</span>  的生成子图（induced subgraph），并用之前提到的基于矩阵乘法的代数方法算出剩余三角形的数量。其复杂度为 <span class="math">$O(|V_2|^\omega)$</span>  。由 <span class="math">$\textstyle{2m \geq \sum_{v\in V_2} d_v > |V_2|\cdot \gamma}$</span>  ，可知 <span class="math">$|V_2| < 2m/\gamma$</span>  。</p><p>总体复杂度为:</p><p class="math">$$O\left(m\cdot \gamma + \left(\frac{2m}{\gamma}\right)^\omega\right) = O\left(m^{2\omega/(\omega + 1)}\right) = O\left(m^{1.41}\right)$$</p> <p>讨论：在稀疏图里面，我们有 <span class="math">$m = O(n\log n)$</span>  ，因此第2个方法要比第1个方法有更好的渐进复杂度。</p><p>对于稠密图有 <span class="math">$m = \Omega(n^2)$</span> , 此时第1个方法更好。</p>
